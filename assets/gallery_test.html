<!doctype html>
<html lang="da">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Gallery Test - Skj√∏d Forsamlingshus</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
        background: #f5f5f5;
      }
      h1 {
        color: #c85a3f;
        text-align: center;
      }
      .gallery-container {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        gap: 20px;
        margin-top: 30px;
      }
      .gallery-item {
        background: white;
        border-radius: 8px;
        overflow: hidden;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        transition: transform 0.3s;
      }
      .gallery-item:hover {
        transform: translateY(-5px);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
      }
      .gallery-image-wrapper {
        position: relative;
        padding-bottom: 75%; /* 4:3 aspect ratio */
        overflow: hidden;
        background: #f0f0f0;
      }
      .gallery-image-wrapper img {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 100%;
        height: 100%;
        object-fit: cover;
        object-position: center;
      }
      .image-info {
        padding: 15px;
        font-size: 14px;
        color: #666;
      }
      .image-name {
        font-weight: bold;
        color: #333;
        margin-bottom: 5px;
      }
      .loading {
        text-align: center;
        padding: 40px;
        color: #666;
      }
      .error {
        text-align: center;
        padding: 40px;
        color: #c85a3f;
      }
      .info-box {
        background: #fff;
        padding: 20px;
        border-radius: 8px;
        margin-bottom: 20px;
        border-left: 4px solid #c85a3f;
      }
    </style>
  </head>
  <body>
    <h1>üñºÔ∏è Gallery Test - Skj√∏d Forsamlingshus</h1>

    <div class="info-box">
      <strong>Automated Gallery System</strong><br />
      All images in <code>images/gallery/</code> folder are automatically
      displayed below with uniform sizing.
    </div>

    <div id="gallery-status" class="loading">Loading images...</div>
    <div id="gallery" class="gallery-container"></div>

    <script>
      const galleryContainer = document.getElementById("gallery");
      const statusDiv = document.getElementById("gallery-status");
      const galleryPath = "images/gallery/";

      async function loadGallery() {
        try {
          // Try PHP endpoint
          const response = await fetch("get_gallery_images.php");
          if (response.ok) {
            const images = await response.json();
            displayImages(images);
          } else {
            loadFallbackImages();
          }
        } catch (error) {
          console.log("Using fallback loading");
          loadFallbackImages();
        }
      }

      function loadFallbackImages() {
        const knownImages = [
          "forsamlingshus.jpg",
          "forsamlingshus1.jpg",
          "forsamlingshuset-1200x1200.png",
        ];
        const images = knownImages.map((img) => galleryPath + img);
        displayImages(images);
      }

      function displayImages(images) {
        statusDiv.style.display = "none";

        if (images.length === 0) {
          statusDiv.style.display = "block";
          statusDiv.className = "error";
          statusDiv.textContent = "No images found in gallery folder.";
          return;
        }

        images.forEach((imagePath, index) => {
          const item = document.createElement("div");
          item.className = "gallery-item";

          const wrapper = document.createElement("div");
          wrapper.className = "gallery-image-wrapper";

          const link = document.createElement("a");
          link.href = imagePath;
          link.target = "_blank";

          const img = document.createElement("img");
          img.src = imagePath;
          img.alt = "Gallery Image " + (index + 1);
          img.loading = "lazy";

          const info = document.createElement("div");
          info.className = "image-info";

          const name = document.createElement("div");
          name.className = "image-name";
          name.textContent = imagePath.split("/").pop();

          img.onload = function () {
            const dimensions = document.createElement("div");
            dimensions.textContent = `${this.naturalWidth} √ó ${this.naturalHeight}px`;
            info.appendChild(name);
            info.appendChild(dimensions);
          };

          img.onerror = function () {
            info.innerHTML = '<div class="image-name">‚ùå Failed to load</div>';
          };

          link.appendChild(img);
          wrapper.appendChild(link);
          item.appendChild(wrapper);
          item.appendChild(info);
          galleryContainer.appendChild(item);
        });

        statusDiv.textContent = `‚úì Loaded ${images.length} image(s)`;
        statusDiv.style.display = "block";
        statusDiv.className = "loading";
        statusDiv.style.color = "#4CAF50";
      }

      loadGallery();
    </script>
  </body>
</html>
